<!--D:\Projects\Sign-Language-Flask\templates\index.html-->
<!DOCTYPE html>
<link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YOLO Sign Language Detection</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        #video-container {
            position: relative;
            width: 640px;
            height: 480px;
        }
        #chat-container {
            height: 480px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">YOLO Sign Language Detection</a>
            <ul class="navbar-nav ms-auto">
                <li class="nav-item">
                    <a class="nav-link" href="{{ url_for('logout') }}">Logout</a>
                </li>
            </ul>
        </div>
    </nav>

    <div class="container mt-4">
        <div class="row">
            <div class="col-md-8">
                <div id="video-container">
                    <img src="{{ url_for('video_feed') }}" width="640" height="480">
                </div>
                <div class="mt-3">
                    <h4>Detected Sign: <span id="detected-sign"></span></h4>
                </div>
            </div>
            <div class="col-md-4">
                <div id="chat-container" class="border p-3 mb-3">
                    <!-- Chat messages will be displayed here -->
                </div>
                <div class="input-group">
                    <input type="text" id="user-input" class="form-control" placeholder="Type your message...">
                    <button class="btn btn-primary" id="send-btn">Send</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        function updatePrediction() {
            $.get('/get_prediction', function(data) {
                if (data.prediction) {
                    $('#detected-sign').text(data.prediction);
                }
            });
        }
    </script>
        setInterval(updatePrediction, 1000);

        $('#send-btn').click(function() {
            var userInput = $('#user-input').val();
            if (userInput.trim() !== '') {
                $('#chat-container').append('<p><strong>You:</strong> ' + userInput + '</p>');
                $('#user-input').val('');
                $.ajax({
                    url: '/get_gemini_response',
                    method: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify({ user_input: userInput }),
                    success: function(data) {
                        $('#chat-container').append('<p><strong>Gemini:</strong> ' + data.response + '</p>');
                        $('#chat-container').scrollTop($('#chat-container')[0].scrollHeight);
                    }
                });
            }
        });

        $('#user-input').keypress(function(e) {
            if (e.which == 13) {
                $('#send-btn').click();
                return false;
            }
        });
    </script>
</body>
</html>